//@ts-check

import globals from 'globals';
import js from '@eslint/js';
import ts from 'typescript-eslint';
import react from 'eslint-plugin-react';
import astro from 'eslint-plugin-astro';
import a11y from 'eslint-plugin-jsx-a11y';
import prettierRecommended from 'eslint-plugin-prettier/recommended';

/** @type {import('eslint').Linter.Config[]} */
export default [
	// Global config
	{
		languageOptions: {
			globals: { ...globals.browser, ...globals.node },
			parserOptions: {
				projectService: true,
				tsconfigRootDir: import.meta.dirname,
			},
		},
	},

	// Sharable configs from plugins
	js.configs.recommended,
	...ts.configs.recommendedTypeChecked,
	...ts.configs.stylisticTypeChecked,
	// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
	react.configs.flat.recommended,
	...astro.configs.recommended,
	a11y.flatConfigs.recommended,
	prettierRecommended,

	// Custom config
	{
		rules: {
			'prettier/prettier': [
				'warn',
				{
					EndOfLine: 'auto',
				},
			],
		},
		settings: {
			react: {
				version: 'detect',
			},
		},
	},
	// Ignores must be in own object
	{
		ignores: ['node_modules/', 'dist/', 'build/', '.*/', '**/env.d.ts'],
	},

	// Seemingly no way to have sharable configs be scoped to filetypes
	// {
	// 	files: ['**/*.{{,c,m}{j,t}s,{j,t}sx,astro}'],
	// },
];
